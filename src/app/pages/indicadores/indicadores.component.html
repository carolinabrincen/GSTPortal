<div class="content-block dx-card responsive-paddings padding-10">

    <dx-tab-panel>
        <dxi-item title="ScoreCard">
            <br><br>

            <div>

                <div class="dx-field">
        
                    <div class="dx-field-value d-block mr-0 ml-auto" style="width: 20%;">
                        <dx-button stylingMode="contained" text="Actualizar" icon="refresh" type="normal" [width]="240" (onClick)="clickClientesRutas($event)">
                        </dx-button>
                    </div>
        
                </div>
            </div>
            <br>
            <!--<dx-responsive-box>
                <dxi-col [ratio]=".35"></dxi-col>
                <dxi-col [ratio]="1"></dxi-col>
                <dxi-col [ratio]=".25"></dxi-col>

                <dxi-col [ratio]="1"></dxi-col>
                
        

                <dxi-row [ratio]="1"></dxi-row>
                <dxi-row [ratio]="1"></dxi-row>
                <dxi-row [ratio]="1"></dxi-row>
                <dxi-row [ratio]="1"></dxi-row>
                <dxi-row [ratio]="1"></dxi-row>
        

                <dxi-item>
                    <dxi-location screen="md lg" [row]="0" [col]="0"></dxi-location>
                    <dxi-location style="margin-top: 1rem" screen="xs sm" [row]="0" [col]="0" [colspan]="12"></dxi-location>
                    <div>Tipo de operación:</div>
                </dxi-item>
                <dxi-item>
                    <dxi-location screen="md lg" [row]="0" [col]="1"></dxi-location>
                    <dxi-location style="margin-top: 0.5rem" screen="xs sm" [row]="1" [col]="0" [colspan]="12"></dxi-location>
                    <dx-tag-box [items]="tipoOperacion" [showSelectionControls]="true" [maxDisplayedTags]="4" [dataSource]="tipoOperacion" displayExpr="nombre" valueExpr="id" (onValueChanged)="seleccionarTipoOpe($event)">
                    </dx-tag-box>
                </dxi-item>
        
                <dxi-item>
                    <dxi-location screen="md lg" [row]="0" [col]="3"></dxi-location>
                    <dxi-location style="margin-top: .20rem" screen="xs sm" [row]="12" [col]="0" [colspan]="12"></dxi-location>
                    <div>
                        <dx-button stylingMode="contained" text="Buscar" icon="search" type="normal" [width]="120" (onClick)="buscarClick($event)">
                        </dx-button>
                    </div>
                </dxi-item>

            </dx-responsive-box>
            <br><br>-->
                    <h3>Ingresos por flete (sin ajuste por provisiones)</h3>

                    <dx-data-grid  #ING id="gridContainer1" [dataSource]="ingresos" [height]="500"[showBorders]="true" [columnAutoWidth]="true"
                    (onRowPrepared)="onRowPreparedI($event)" (onCellPrepared)="onCellPreparedI($event)">
        
                    <dxo-search-panel [visible]="true" [width]="240" placeholder="Buscar..."></dxo-search-panel>
                    <dxo-header-filter [visible]="true"></dxo-header-filter>

                    <dxi-column dataField="mes" caption="" [fixed]="true" [groupIndex]="0"></dxi-column>
                    <dxi-column dataField="" caption="" [fixed]="true"></dxi-column>
                    <dxi-column name="fake" [showInColumnChooser]="false" [fixed]="true" fixedPosition="left" [width]="0.01"></dxi-column>  

                    <dxi-column dataField="operacion" caption="Operación" [fixed]="true"></dxi-column>
                    <dxi-column dataField="cuatitlan" caption="Cuautitlan" format="$ #,###,###.##;-$ #,##0.##"></dxi-column>
                    <dxi-column dataField="tultitlan" caption="Tultitlan" format="$ #,###,###.##;-$ #,##0.##"></dxi-column>
                    <dxi-column dataField="guadalajara" caption="Guadalajara" format="$ #,###,###.##;-$ #,##0.##"></dxi-column>
                    <dxi-column dataField="hermosillo" caption="Hermosillo" format="$ #,###,###.##;-$ #,##0.##"></dxi-column>
                    <dxi-column dataField="mexicali" caption="Mexicali" format="$ #,###,###.##;-$ #,##0.##"></dxi-column>
                    <dxi-column dataField="orizaba" caption="Orizaba" format="$ #,###,###.##;-$ #,##0.##"></dxi-column>
                    <dxi-column dataField="ramosArizpe" caption="Ramos Arizpe" format="$ #,###,###.##;-$ #,##0.##"></dxi-column>
                    <dxi-column dataField="total" caption="Total" format="$ #,###,###.##;-$ #,##0.##"></dxi-column>
                    
                    <dxo-summary>
                        <dxi-group-item column="fake" [alignByColumn]="true"></dxi-group-item>
                        <!-- SUMARY DE GRUPO -->
                        <dxi-group-item column="cuatitlan" summaryType="sum" displayFormat="{0}" valueFormat="$ #,###,###.##;-$ #,##0.##" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                        <dxi-group-item column="tultitlan" summaryType="sum" displayFormat="{0}" valueFormat="$ #,###,###.##;-$ #,##0.##" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                        <dxi-group-item column="guadalajara" summaryType="sum" displayFormat="{0}" valueFormat="$ #,###,###.##;-$ #,##0.##" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                        <dxi-group-item column="hermosillo" summaryType="sum" displayFormat="{0}" valueFormat="$ #,###,###.##;-$ #,##0.##" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                        <dxi-group-item column="mexicali" summaryType="sum" displayFormat="{0}" valueFormat="$ #,###,###.##;-$ #,##0.##" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                        <dxi-group-item column="orizaba" summaryType="sum" displayFormat="{0}" valueFormat="$ #,###,###.##;-$ #,##0.##" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                        <dxi-group-item column="ramosArizpe" summaryType="sum" displayFormat="{0}" valueFormat="$ #,###,###.##;-$ #,##0.##" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                        <dxi-group-item column="total" summaryType="sum" displayFormat="{0}" valueFormat="$ #,###,###.##;-$ #,##0.##" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>

                        <dxi-total-item column="cuatitlan" summaryType="sum" valueFormat="$ #,##0.##;-$ #,##0.##" displayFormat="{0}"></dxi-total-item>
                        <dxi-total-item column="tultitlan" summaryType="sum" valueFormat="$ #,##0.##;-$ #,##0.##" displayFormat="{0}"></dxi-total-item>
                        <dxi-total-item column="guadalajara" summaryType="sum" valueFormat="$ #,##0.##;-$ #,##0.##" displayFormat="{0}"></dxi-total-item>
                        <dxi-total-item column="hermosillo" summaryType="sum" valueFormat="$ #,##0.##;-$ #,##0.##" displayFormat="{0}"></dxi-total-item>
                        <dxi-total-item column="mexicali" summaryType="sum" valueFormat="$ #,##0.##;-$ #,##0.##" displayFormat="{0}"></dxi-total-item>
                        <dxi-total-item column="orizaba" summaryType="sum" valueFormat="$ #,##0.##;-$ #,##0.##" displayFormat="{0}"></dxi-total-item>
                        <dxi-total-item column="ramosArizpe" summaryType="sum" valueFormat="$ #,##0.##;-$ #,##0.##" displayFormat="{0}"></dxi-total-item>
                        <dxi-total-item column="total" summaryType="sum" valueFormat="$ #,##0.##;-$ #,##0.##" displayFormat="{0}"></dxi-total-item>
                    </dxo-summary>

                    <dxo-group-panel [visible]="false"></dxo-group-panel>
                    <dxo-grouping #expand [autoExpandAll]="false"></dxo-grouping>
                    <dxo-export [enabled]="true" fileName="Ingreso" [customizeExcelCell]="customizeI"></dxo-export>
                    <dxo-paging [pageSize]="60"></dxo-paging>
                    <dxo-sorting mode="none"></dxo-sorting>

                    </dx-data-grid>
                    <br><br>
                    
                    <h3>Kilómetros</h3>

                    <dx-data-grid  #KMS id="gridContainer2" [dataSource]="kilomentros" [height]="500"[showBorders]="true" [columnAutoWidth]="true"
                    (onRowPrepared)="onRowPreparedK($event)" (onCellPrepared)="onCellPreparedK($event)">
        
                    <dxo-search-panel [visible]="true" [width]="240" placeholder="Buscar..."></dxo-search-panel>
                        <dxo-header-filter [visible]="true"></dxo-header-filter>

                        <dxi-column dataField="mes" caption="" [fixed]="true" [groupIndex]="0"></dxi-column>
                        <dxi-column dataField="" caption="" [fixed]="true"></dxi-column>
                        <dxi-column name="fake" [showInColumnChooser]="false" [fixed]="true" fixedPosition="left" [width]="0.01"></dxi-column>  

                        <dxi-column dataField="operacion" caption="Operación" [fixed]="true"></dxi-column>
                        <dxi-column dataField="cuatitlan" caption="Cuautitlan" [format]="separator"></dxi-column>
                        <dxi-column dataField="tultitlan" caption="Tultitlan" [format]="separator"></dxi-column>
                        <dxi-column dataField="guadalajara" caption="Guadalajara" [format]="separator"></dxi-column>
                        <dxi-column dataField="hermosillo" caption="Hermosillo" [format]="separator"></dxi-column>
                        <dxi-column dataField="mexicali" caption="Mexicali" [format]="separator"></dxi-column>
                        <dxi-column dataField="orizaba" caption="Orizaba" [format]="separator"></dxi-column>
                        <dxi-column dataField="ramosArizpe" caption="Ramos Arizpe" [format]="separator"></dxi-column>
                        <dxi-column dataField="total" caption="Total" [format]="separator"></dxi-column>

                        <dxo-summary>
                            <dxi-group-item column="fake" [alignByColumn]="true"></dxi-group-item>
                            <!-- SUMARY DE GRUPO -->
                            <dxi-group-item column="cuatitlan" summaryType="sum" displayFormat="{0}" [valueFormat]="separator" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="tultitlan" summaryType="sum" displayFormat="{0}" [valueFormat]="separator" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="guadalajara" summaryType="sum" displayFormat="{0}" [valueFormat]="separator" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="hermosillo" summaryType="sum" displayFormat="{0}" [valueFormat]="separator" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="mexicali" summaryType="sum" displayFormat="{0}" [valueFormat]="separator" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="orizaba" summaryType="sum" displayFormat="{0}" [valueFormat]="separator" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="ramosArizpe" summaryType="sum" displayFormat="{0}" [valueFormat]="separator" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="total" summaryType="sum" displayFormat="{0}" [valueFormat]="separator" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
    
                            <dxi-total-item column="cuatitlan" summaryType="sum" [valueFormat]="separator" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="tultitlan" summaryType="sum" [valueFormat]="separator" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="guadalajara" summaryType="sum" [valueFormat]="separator" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="hermosillo" summaryType="sum" [valueFormat]="separator" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="mexicali" summaryType="sum" [valueFormat]="separator" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="orizaba" summaryType="sum" [valueFormat]="separator" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="ramosArizpe" summaryType="sum" [valueFormat]="separator" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="total" summaryType="sum" [valueFormat]="separator" displayFormat="{0}"></dxi-total-item>
                        </dxo-summary>

                        <dxo-group-panel [visible]="false"></dxo-group-panel>
                        <dxo-grouping #expand [autoExpandAll]="false"></dxo-grouping>
                        <dxo-export [enabled]="true" fileName="Kilómetros" [customizeExcelCell]="customizeK"></dxo-export>
                        <dxo-paging [pageSize]="60"></dxo-paging>
                        <dxo-sorting mode="none"></dxo-sorting>

                    </dx-data-grid>
                    <br><br>

                    <h3>Viajes totales</h3>
                    <dx-data-grid  #VJS id="gridContainer4" [dataSource]="viajes" [height]="500"[showBorders]="true" [columnAutoWidth]="true"
                    (onRowPrepared)="onRowPreparedV($event)" (onCellPrepared)="onCellPreparedV($event)">
        
                    <dxo-search-panel [visible]="true" [width]="240" placeholder="Buscar..."></dxo-search-panel>
                        <dxo-header-filter [visible]="true"></dxo-header-filter>

                        <dxi-column dataField="mes" caption="" [fixed]="true" [groupIndex]="0"></dxi-column>
                        <dxi-column dataField="" caption="" [fixed]="true"></dxi-column>
                        <dxi-column name="fake" [showInColumnChooser]="false" [fixed]="true" fixedPosition="left" [width]="0.01"></dxi-column>  

                        <dxi-column dataField="operacion" caption="Operación" [fixed]="true"></dxi-column>
                        <dxi-column dataField="cuatitlan" caption="Cuautitlan" [format]="separator"></dxi-column>
                        <dxi-column dataField="tultitlan" caption="Tultitlan" [format]="separator"></dxi-column>
                        <dxi-column dataField="guadalajara" caption="Guadalajara" [format]="separator"></dxi-column>
                        <dxi-column dataField="hermosillo" caption="Hermosillo" [format]="separator"></dxi-column>
                        <dxi-column dataField="mexicali" caption="Mexicali" [format]="separator"></dxi-column>
                        <dxi-column dataField="orizaba" caption="Orizaba" [format]="separator"></dxi-column>
                        <dxi-column dataField="ramosArizpe" caption="Ramos Arizpe" [format]="separator"></dxi-column>
                        <dxi-column dataField="total" caption="Total" [format]="separator"></dxi-column>
                        
                        <dxo-summary>
                            <dxi-group-item column="fake" [alignByColumn]="true"></dxi-group-item>
                            <!-- SUMARY DE GRUPO -->
                            <dxi-group-item column="cuatitlan" summaryType="sum" displayFormat="{0}" [valueFormat]="separator" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="tultitlan" summaryType="sum" displayFormat="{0}" [valueFormat]="separator" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="guadalajara" summaryType="sum" displayFormat="{0}" [valueFormat]="separator" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="hermosillo" summaryType="sum" displayFormat="{0}" [valueFormat]="separator" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="mexicali" summaryType="sum" displayFormat="{0}" [valueFormat]="separator" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="orizaba" summaryType="sum" displayFormat="{0}" [valueFormat]="separator" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="ramosArizpe" summaryType="sum" displayFormat="{0}" [valueFormat]="separator" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="total" summaryType="sum" displayFormat="{0}" [valueFormat]="separator" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
    
                            <dxi-total-item column="cuatitlan" summaryType="sum" [valueFormat]="separator" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="tultitlan" summaryType="sum" [valueFormat]="separator" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="guadalajara" summaryType="sum" [valueFormat]="separator" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="hermosillo" summaryType="sum" [valueFormat]="separator" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="mexicali" summaryType="sum" [valueFormat]="separator" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="orizaba" summaryType="sum" [valueFormat]="separator" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="ramosArizpe" summaryType="sum" [valueFormat]="separator" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="total" summaryType="sum" [valueFormat]="separator" displayFormat="{0}"></dxi-total-item>
                        </dxo-summary>

                        <dxo-group-panel [visible]="false"></dxo-group-panel>
                        <dxo-grouping #expand [autoExpandAll]="false"></dxo-grouping>
                        <dxo-export [enabled]="true" fileName="Viajes totales" [customizeExcelCell]="customizeV"></dxo-export>
                        <dxo-paging [pageSize]="60"></dxo-paging>
                        <dxo-sorting mode="none"></dxo-sorting>
                    
                    </dx-data-grid>
                    <br><br>

                    <h3>Viajes cargados</h3>
                    <dx-data-grid  #VJS id="gridContainer7" [dataSource]="viajesCargados" [height]="500"[showBorders]="true" [columnAutoWidth]="true"
                    (onRowPrepared)="onRowPreparedVC($event)" (onCellPrepared)="onCellPreparedVC($event)">
        
                    <dxo-search-panel [visible]="true" [width]="240" placeholder="Buscar..."></dxo-search-panel>
                        <dxo-header-filter [visible]="true"></dxo-header-filter>

                        <dxi-column dataField="mes" caption="" [fixed]="true" [groupIndex]="0"></dxi-column>
                        <dxi-column dataField="" caption="" [fixed]="true"></dxi-column>
                        <dxi-column name="fake" [showInColumnChooser]="false" [fixed]="true" fixedPosition="left" [width]="0.01"></dxi-column>  

                        <dxi-column dataField="operacion" caption="Operación" [fixed]="true"></dxi-column>
                        <dxi-column dataField="cuatitlan" caption="Cuautitlan" [format]="separator"></dxi-column>
                        <dxi-column dataField="tultitlan" caption="Tultitlan" [format]="separator"></dxi-column>
                        <dxi-column dataField="guadalajara" caption="Guadalajara" [format]="separator"></dxi-column>
                        <dxi-column dataField="hermosillo" caption="Hermosillo" [format]="separator"></dxi-column>
                        <dxi-column dataField="mexicali" caption="Mexicali" [format]="separator"></dxi-column>
                        <dxi-column dataField="orizaba" caption="Orizaba" [format]="separator"></dxi-column>
                        <dxi-column dataField="ramosArizpe" caption="Ramos Arizpe" [format]="separator"></dxi-column>
                        <dxi-column dataField="total" caption="Total" [format]="separator"></dxi-column>
                        
                        <dxo-summary>
                            <dxi-group-item column="fake" [alignByColumn]="true"></dxi-group-item>
                            <!-- SUMARY DE GRUPO -->
                            <dxi-group-item column="cuatitlan" summaryType="sum" displayFormat="{0}" [valueFormat]="separator" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="tultitlan" summaryType="sum" displayFormat="{0}" [valueFormat]="separator" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="guadalajara" summaryType="sum" displayFormat="{0}" [valueFormat]="separator" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="hermosillo" summaryType="sum" displayFormat="{0}" [valueFormat]="separator" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="mexicali" summaryType="sum" displayFormat="{0}" [valueFormat]="separator" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="orizaba" summaryType="sum" displayFormat="{0}" [valueFormat]="separator" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="ramosArizpe" summaryType="sum" displayFormat="{0}" [valueFormat]="separator" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="total" summaryType="sum" displayFormat="{0}" [valueFormat]="separator" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
    
                            <dxi-total-item column="cuatitlan" summaryType="sum" [valueFormat]="separator" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="tultitlan" summaryType="sum" [valueFormat]="separator" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="guadalajara" summaryType="sum" [valueFormat]="separator" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="hermosillo" summaryType="sum" [valueFormat]="separator" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="mexicali" summaryType="sum" [valueFormat]="separator" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="orizaba" summaryType="sum" [valueFormat]="separator" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="ramosArizpe" summaryType="sum" [valueFormat]="separator" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="total" summaryType="sum" [valueFormat]="separator" displayFormat="{0}"></dxi-total-item>
                        </dxo-summary>

                        <dxo-group-panel [visible]="false"></dxo-group-panel>
                        <dxo-grouping #expand [autoExpandAll]="false"></dxo-grouping>
                        <dxo-export [enabled]="true" fileName="Viajes cargados" [customizeExcelCell]="customizeVC"></dxo-export>
                        <dxo-paging [pageSize]="60"></dxo-paging>
                        <dxo-sorting mode="none"></dxo-sorting>
                    
                    </dx-data-grid>
                    <br><br>

                    <h3>Ingreso por kilómetro</h3>

                    <dx-data-grid #priceDataGrid [dataSource]="precioMeta" [showColumnLines]="true" [rowAlternationEnabled]="true" [columnAutoWidth]="true" [allowColumnResizing]="true" [allowColumnReordering]="false"
                    [columnAutoWidth]="true" [showBorders]="true" (onCellPrepared)="onCellPreparedPM($event)">
                       
                       <dxi-column dataField="operacion" caption="Descripción" [fixed]="true" [width]="180"></dxi-column>
                       <dxi-column dataField="cuatitlan" caption="Cuautitlan" format="$ #,###,###.##;-$ #,##0.##"></dxi-column>
                       <dxi-column dataField="tultitlan" caption="Tultitlan" format="$ #,###,###.##;-$ #,##0.##"></dxi-column>
                       <dxi-column dataField="guadalajara" caption="Guadalajara" format="$ #,###,###.##;-$ #,##0.##"></dxi-column>
                       <dxi-column dataField="hermosillo" caption="Hermosillo" format="$ #,###,###.##;-$ #,##0.##"></dxi-column>
                       <dxi-column dataField="mexicali" caption="Mexicali" format="$ #,###,###.##;-$ #,##0.##"></dxi-column>
                       <dxi-column dataField="orizaba" caption="Orizaba" format="$ #,###,###.##;-$ #,##0.##"></dxi-column>
                       <dxi-column dataField="ramosArizpe" caption="Ramos Arizpe" format="$ #,###,###.##;-$ #,##0.##"></dxi-column>
                       <dxi-column dataField="total" caption="Total" format="$ #,###,###.##;-$ #,##0.##"></dxi-column>
                       
                       <dxo-summary>
                           <!-- SUMARY DE GRUPO -->
                           <dxi-group-item column="cuatitlan" summaryType="sum" displayFormat="{0}" [valueFormat]="redondearIK" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                           <dxi-group-item column="tultitlan" summaryType="sum" displayFormat="{0}" [valueFormat]="redondearIK" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                           <dxi-group-item column="guadalajara" summaryType="sum" displayFormat="{0}" [valueFormat]="redondearIK" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                           <dxi-group-item column="hermosillo" summaryType="sum" displayFormat="{0}" [valueFormat]="redondearIK" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                           <dxi-group-item column="mexicali" summaryType="sum" displayFormat="{0}" [valueFormat]="redondearIK" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                           <dxi-group-item column="orizaba" summaryType="sum" displayFormat="{0}" [valueFormat]="redondearIK" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                           <dxi-group-item column="ramosArizpe" summaryType="sum" displayFormat="{0}" [valueFormat]="redondearIK" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                           <dxi-group-item column="total" summaryType="sum" displayFormat="{0}" [valueFormat]="redondearIK" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                       </dxo-summary>

                       <dxo-group-panel [visible]="false"></dxo-group-panel>
                       <dxo-grouping #expand [autoExpandAll]="false"></dxo-grouping>
           
                       <div *dxTemplate="let data of 'headerTemplate'">
                           <div style="font-weight: bolder; color: black;">
                               {{ data.column.caption }}
                           </div>
                       </div>
                       <div *dxTemplate="let cell of 'cellTemplateBold'">
                           <div style="font-weight: bold;">{{cell.text}}</div>
                       </div>
                       <dxo-export [enabled]="true" fileName="Ingreso-Kilómetro" [customizeExcelCell]="customizeIK"></dxo-export>
                       <dxo-paging [pageSize]="60"></dxo-paging>
                       <dxo-sorting mode="none"></dxo-sorting>
                   </dx-data-grid>
                   <br>

                   <dx-data-grid  #INGXKMS id="gridContainer3" [dataSource]="ingresosKilometros" [height]="500"[showBorders]="true" [columnAutoWidth]="true"
                   (onRowPrepared)="onRowPreparedIK($event)" (onCellPrepared)="onCellPreparedIK($event)" [customizeExportData]="customizeExportData">
    
                   <dxo-search-panel [visible]="true" [width]="240" placeholder="Buscar..."></dxo-search-panel>
                        <dxo-header-filter [visible]="true"></dxo-header-filter>

                        <dxi-column dataField="mes" caption="" [fixed]="true" [groupIndex]="0"></dxi-column>
                        <dxi-column dataField="" caption="" [fixed]="true"></dxi-column>
                        <dxi-column name="fake" [showInColumnChooser]="false" [fixed]="true" fixedPosition="left" [width]="0.01"></dxi-column>  
    
                        <dxi-column dataField="operacion" caption="Operación" [fixed]="true" [width]="150"></dxi-column>
                        <dxi-column dataField="cuatitlan" caption="Cuautitlan" format="$ #,###,###.##;-$ #,##0.##"></dxi-column>
                        <dxi-column dataField="tultitlan" caption="Tultitlan" format="$ #,###,###.##;-$ #,##0.##"></dxi-column>
                        <dxi-column dataField="guadalajara" caption="Guadalajara" format="$ #,###,###.##;-$ #,##0.##"></dxi-column>
                        <dxi-column dataField="hermosillo" caption="Hermosillo" format="$ #,###,###.##;-$ #,##0.##"></dxi-column>
                        <dxi-column dataField="mexicali" caption="Mexicali" format="$ #,###,###.##;-$ #,##0.##"></dxi-column>
                        <dxi-column dataField="orizaba" caption="Orizaba" format="$ #,###,###.##;-$ #,##0.##"></dxi-column>
                        <dxi-column dataField="ramosArizpe" caption="Ramos Arizpe" format="$ #,###,###.##;-$ #,##0.##"></dxi-column>
                        <dxi-column dataField="total" caption="Total" format="$ #,###,###.##;-$ #,##0.##"></dxi-column>
                        
                        <dxo-summary>
                            <dxi-group-item column="fake" [alignByColumn]="true"></dxi-group-item>
                            <!-- SUMARY DE GRUPO -->
                            <dxi-group-item column="cuatitlan" summaryType="sum" displayFormat="{0}" [valueFormat]="redondearIK" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="tultitlan" summaryType="sum" displayFormat="{0}" [valueFormat]="redondearIK" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="guadalajara" summaryType="sum" displayFormat="{0}" [valueFormat]="redondearIK" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="hermosillo" summaryType="sum" displayFormat="{0}" [valueFormat]="redondearIK" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="mexicali" summaryType="sum" displayFormat="{0}" [valueFormat]="redondearIK" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="orizaba" summaryType="sum" displayFormat="{0}" [valueFormat]="redondearIK" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="ramosArizpe" summaryType="sum" displayFormat="{0}" [valueFormat]="redondearIK" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="total" summaryType="sum" displayFormat="{0}" [valueFormat]="redondearIK" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
        
                            <dxi-total-item column="cuatitlan" summaryType="avg" [valueFormat]="redondearIK" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="tultitlan" summaryType="avg" [valueFormat]="redondearIK" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="guadalajara" summaryType="avg" [valueFormat]="redondearIK" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="hermosillo" summaryType="avg" [valueFormat]="redondearIK" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="mexicali" summaryType="avg" [valueFormat]="redondearIK" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="orizaba" summaryType="avg" [valueFormat]="redondearIK" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="ramosArizpe" summaryType="avg" [valueFormat]="redondearIK" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="total" summaryType="avg" [valueFormat]="redondearIK" displayFormat="{0}"></dxi-total-item>
                        </dxo-summary>

                        <dxo-group-panel [visible]="false"></dxo-group-panel>
                        <dxo-grouping #expand [autoExpandAll]="expandGroup"></dxo-grouping>
                        <dxo-export [enabled]="true" fileName="Ingreso por kilómetro" [customizeExcelCell]="customizeIK"></dxo-export>
                        <dxo-paging [pageSize]="paginacion"></dxo-paging>
                        <dxo-sorting mode="none"></dxo-sorting>

                   </dx-data-grid>
                    <br><br>

                    <h3>Kilómetros por viaje</h3>
                    <dx-data-grid  #KMSXVJS id="gridContainer5" [dataSource]="kilometroViajes" [height]="500"[showBorders]="true" [columnAutoWidth]="true"
                    (onRowPrepared)="onRowPreparedKV($event)" (onCellPrepared)="onCellPreparedKV($event)" [customizeExportData]="customizeExportDataKV">

                    <dxo-search-panel [visible]="true" [width]="240" placeholder="Buscar..."></dxo-search-panel>
                        <dxo-header-filter [visible]="true"></dxo-header-filter>
                        
                        <dxi-column dataField="mes" caption="" [fixed]="true" [groupIndex]="0"></dxi-column>
                        <dxi-column dataField="" caption="" [fixed]="true"></dxi-column>
                        <dxi-column name="fake" [showInColumnChooser]="false" [fixed]="true" fixedPosition="left" [width]="0.01"></dxi-column>  
    
                        <dxi-column dataField="operacion" caption="Operación" [fixed]="true"></dxi-column>
                        <dxi-column dataField="cuatitlan" caption="Cuautitlan" [format]="separatorKV"></dxi-column>
                        <dxi-column dataField="tultitlan" caption="Tultitlan" [format]="separatorKV"></dxi-column>
                        <dxi-column dataField="guadalajara" caption="Guadalajara" [format]="separatorKV"></dxi-column>
                        <dxi-column dataField="hermosillo" caption="Hermosillo" [format]="separatorKV"></dxi-column>
                        <dxi-column dataField="mexicali" caption="Mexicali" [format]="separatorKV"></dxi-column>
                        <dxi-column dataField="orizaba" caption="Orizaba" [format]="separatorKV"></dxi-column>
                        <dxi-column dataField="ramosArizpe" caption="Ramos Arizpe" [format]="separatorKV"></dxi-column>
                        <dxi-column dataField="total" caption="Total" [format]="separatorKV"></dxi-column>
                        
                        <dxo-summary>
                            <dxi-group-item column="fake" [alignByColumn]="true"></dxi-group-item>
                            <!-- SUMARY DE GRUPO -->
                            <dxi-group-item column="cuatitlan" summaryType="sum" displayFormat="{0}" [valueFormat]="separatorKV" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="tultitlan" summaryType="sum" displayFormat="{0}" [valueFormat]="separatorKV" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="guadalajara" summaryType="sum" displayFormat="{0}" [valueFormat]="separatorKV" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="hermosillo" summaryType="sum" displayFormat="{0}" [valueFormat]="separatorKV" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="mexicali" summaryType="sum" displayFormat="{0}" [valueFormat]="separatorKV" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="orizaba" summaryType="sum" displayFormat="{0}" [valueFormat]="separatorKV" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="ramosArizpe" summaryType="sum" displayFormat="{0}" [valueFormat]="separatorKV" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="total" summaryType="sum" displayFormat="{0}" [valueFormat]="separatorKV" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
    
                            <dxi-total-item column="cuatitlan" summaryType="avg" [valueFormat]="separatorKV" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="tultitlan" summaryType="avg" [valueFormat]="separatorKV" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="guadalajara" summaryType="avg" [valueFormat]="separatorKV" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="hermosillo" summaryType="avg" [valueFormat]="separatorKV" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="mexicali" summaryType="avg" [valueFormat]="separatorKV" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="orizaba" summaryType="avg" [valueFormat]="separatorKV" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="ramosArizpe" summaryType="avg" [valueFormat]="separatorKV" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="total" summaryType="avg" [valueFormat]="separatorKV" displayFormat="{0}"></dxi-total-item>
                        </dxo-summary>

                        <dxo-group-panel [visible]="false"></dxo-group-panel>
                        <dxo-grouping #expand [autoExpandAll]="expandGroupKV"></dxo-grouping>
                        <dxo-export [enabled]="true" fileName="Kilómetros po viaje" [customizeExcelCell]="customizeKV"></dxo-export>
                        <dxo-paging [pageSize]="paginacionKV"></dxo-paging>
                        <dxo-sorting mode="none"></dxo-sorting>

                    </dx-data-grid>
                    <br><br>

                    <h3>Ingreso por viaje</h3>
                    <dx-data-grid  #KMSXVJS id="gridContainer6" [dataSource]="ingresoViajes" [height]="500"[showBorders]="true" [columnAutoWidth]="true"
                    (onRowPrepared)="onRowPreparedIV($event)" (onCellPrepared)="onCellPreparedIV($event)" [customizeExportData]="customizeExportDataIV">

                    <dxo-search-panel [visible]="true" [width]="240" placeholder="Buscar..."></dxo-search-panel>
                        <dxo-header-filter [visible]="true"></dxo-header-filter>
                        
                        <dxi-column dataField="mes" caption="" [fixed]="true" [groupIndex]="0"></dxi-column>
                        <dxi-column dataField="" caption="" [fixed]="true"></dxi-column>
                        <dxi-column name="fake" [showInColumnChooser]="false" [fixed]="true" fixedPosition="left" [width]="0.01"></dxi-column>  
    
                        <dxi-column dataField="operacion" caption="Operación" [fixed]="true"></dxi-column>
                        <dxi-column dataField="cuatitlan" caption="Cuautitlan" [format]="separatorIV"></dxi-column>
                        <dxi-column dataField="tultitlan" caption="Tultitlan" [format]="separatorIV"></dxi-column>
                        <dxi-column dataField="guadalajara" caption="Guadalajara" [format]="separatorIV"></dxi-column>
                        <dxi-column dataField="hermosillo" caption="Hermosillo" [format]="separatorIV"></dxi-column>
                        <dxi-column dataField="mexicali" caption="Mexicali" [format]="separatorIV"></dxi-column>
                        <dxi-column dataField="orizaba" caption="Orizaba" [format]="separatorIV"></dxi-column>
                        <dxi-column dataField="ramosArizpe" caption="Ramos Arizpe" [format]="separatorIV"></dxi-column>
                        <dxi-column dataField="total" caption="Total" [format]="separatorIV"></dxi-column>
                        
                        <dxo-summary>
                            <dxi-group-item column="fake" [alignByColumn]="true"></dxi-group-item>
                            <!-- SUMARY DE GRUPO -->
                            <dxi-group-item column="cuatitlan" summaryType="sum" displayFormat="{0}" [valueFormat]="separatorIV" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="tultitlan" summaryType="sum" displayFormat="{0}" [valueFormat]="separatorIV" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="guadalajara" summaryType="sum" displayFormat="{0}" [valueFormat]="separatorIV" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="hermosillo" summaryType="sum" displayFormat="{0}" [valueFormat]="separatorIV" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="mexicali" summaryType="sum" displayFormat="{0}" [valueFormat]="separatorIV" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="orizaba" summaryType="sum" displayFormat="{0}" [valueFormat]="separatorIV" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="ramosArizpe" summaryType="sum" displayFormat="{0}" [valueFormat]="separatorIV" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
                            <dxi-group-item column="total" summaryType="sum" displayFormat="{0}" [valueFormat]="separatorIV" [showInGroupFooter]="false" [alignByColumn]="true"></dxi-group-item>
    
                            <dxi-total-item column="cuatitlan" summaryType="avg" [valueFormat]="separatorIV" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="tultitlan" summaryType="avg" [valueFormat]="separatorIV" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="guadalajara" summaryType="avg" [valueFormat]="separatorIV" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="hermosillo" summaryType="avg" [valueFormat]="separatorIV" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="mexicali" summaryType="avg" [valueFormat]="separatorIV" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="orizaba" summaryType="avg" [valueFormat]="separatorIV" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="ramosArizpe" summaryType="avg" [valueFormat]="separatorIV" displayFormat="{0}"></dxi-total-item>
                            <dxi-total-item column="total" summaryType="avg" [valueFormat]="separatorIV" displayFormat="{0}"></dxi-total-item>
                        </dxo-summary>

                        <dxo-group-panel [visible]="false"></dxo-group-panel>
                        <dxo-grouping #expand [autoExpandAll]="expandGroupKV"></dxo-grouping>
                        <dxo-export [enabled]="true" fileName="Ingreso por viaje" [customizeExcelCell]="customizeIV"></dxo-export>
                        <dxo-paging [pageSize]="paginacionKV"></dxo-paging>
                        <dxo-sorting mode="none"></dxo-sorting>

                    </dx-data-grid>
                    <br><br>

                    <h3>Operadores UDN</h3>
                    <dx-data-grid  #OUDN id="gridContainer7" [dataSource]="operadoresUDN" [height]="500"[showBorders]="true" [columnAutoWidth]="true"
                    (onRowPrepared)="onRowPreparedOUDN($event)" (onCellPrepared)="onCellPreparedOUDN($event)" >

                    <dxo-search-panel [visible]="true" [width]="240" placeholder="Buscar..."></dxo-search-panel>
                        <dxo-header-filter [visible]="true"></dxo-header-filter>
                        
                        <dxi-column dataField="mes" caption="Mes" [fixed]="true"></dxi-column>
                        <dxi-column dataField="cuatitlan" caption="Cuautitlan" format="#,##0.##;-$ #,##0.##"></dxi-column>
                        <dxi-column dataField="tultitlan" caption="Tultitlan" format="#,##0.##;-$ #,##0.##"></dxi-column>
                        <dxi-column dataField="guadalajara" caption="Guadalajara" format="#,##0.##;-$ #,##0.##"></dxi-column>
                        <dxi-column dataField="hermosillo" caption="Hermosillo" format="#,##0.##;-$ #,##0.##"></dxi-column>
                        <dxi-column dataField="mexicali" caption="Mexicali" format="#,##0.##;-$ #,##0.##"></dxi-column>
                        <dxi-column dataField="orizaba" caption="Orizaba" format="#,##0.##;-$ #,##0.##"></dxi-column>
                        <dxi-column dataField="ramosArizpe" caption="Ramos Arizpe" format="#,##0.##;-$ #,##0.##"></dxi-column>
                        <dxi-column dataField="total" caption="Total" format="#,##0.##;-$ #,##0.##"></dxi-column>
                        
                   
                        <dxo-group-panel [visible]="false"></dxo-group-panel>
                        <dxo-grouping #expand [autoExpandAll]="expandGroupKV"></dxo-grouping>
                        <dxo-export [enabled]="true" fileName="Operadores UDN"></dxo-export>
                        <dxo-paging [pageSize]="paginacionKV"></dxo-paging>
                        <dxo-sorting mode="none"></dxo-sorting>

                    </dx-data-grid>
                    <br><br>

                    <h3>Ingreso por Operador</h3>
                    <dx-data-grid  #IOUDN id="gridContainer8" [dataSource]="ingresoOperador" [height]="500"[showBorders]="true" [columnAutoWidth]="true"
                    (onRowPrepared)="onRowPreparedIO($event)" (onCellPrepared)="onCellPreparedIO($event)">

                    <dxo-search-panel [visible]="true" [width]="240" placeholder="Buscar..."></dxo-search-panel>
                        <dxo-header-filter [visible]="true"></dxo-header-filter>
                        
                        <dxi-column dataField="mes" caption="Mes" [fixed]="true"></dxi-column>
                        <dxi-column dataField="cuatitlan" caption="Cuautitlan" [format]="separatorIV"></dxi-column>
                        <dxi-column dataField="tultitlan" caption="Tultitlan" [format]="separatorIV"></dxi-column>
                        <dxi-column dataField="guadalajara" caption="Guadalajara" [format]="separatorIV"></dxi-column>
                        <dxi-column dataField="hermosillo" caption="Hermosillo" [format]="separatorIV"></dxi-column>
                        <dxi-column dataField="mexicali" caption="Mexicali" [format]="separatorIV"></dxi-column>
                        <dxi-column dataField="orizaba" caption="Orizaba" [format]="separatorIV"></dxi-column>
                        <dxi-column dataField="ramosArizpe" caption="Ramos Arizpe" [format]="separatorIV"></dxi-column>
                        <dxi-column dataField="total" caption="Total" [format]="separatorIV"></dxi-column>
                        
                   
                        <dxo-group-panel [visible]="false"></dxo-group-panel>
                        <dxo-grouping #expand [autoExpandAll]="expandGroupKV"></dxo-grouping>
                        <dxo-export [enabled]="true" fileName="Ingreso por Operador" ></dxo-export>
                        <dxo-paging [pageSize]="paginacionKV"></dxo-paging>
                        <dxo-sorting mode="none"></dxo-sorting>

                    </dx-data-grid>

        </dxi-item>

        <dxi-item title="KMS Mensuales">
            <br><br>
            <dx-responsive-box>
                <dxi-col [ratio]=".20"></dxi-col>
                <dxi-col [ratio]="1"></dxi-col>
                <dxi-col [ratio]=".25"></dxi-col>

                <dxi-col [ratio]="1"></dxi-col>
                
        

                <dxi-row [ratio]="1"></dxi-row>
                <dxi-row [ratio]="1"></dxi-row>
                <dxi-row [ratio]="1"></dxi-row>
                <dxi-row [ratio]="1"></dxi-row>
                <dxi-row [ratio]="1"></dxi-row>
        

                <dxi-item>
                    <dxi-location screen="md lg" [row]="0" [col]="0"></dxi-location>
                    <dxi-location style="margin-top: 1rem" screen="xs sm" [row]="10" [col]="0" [colspan]="12"></dxi-location>
                    <div>Periodo:</div>
                </dxi-item>
        
                <dxi-item>
                    <dxi-location screen="md lg" [row]="0" [col]="1"></dxi-location>
                    <dxi-location style="margin-top: 0.5rem" screen="xs sm" [row]="11" [col]="0" [colspan]="12"></dxi-location>
                    <dx-select-box [items]="periodo" displayExpr="periodo" valueExpr="periodo" (onValueChanged)="seleccionarPeriodo($event)">
                    </dx-select-box>
                </dxi-item>
        
                <dxi-item>
                    <dxi-location screen="md lg" [row]="0" [col]="3"></dxi-location>
                    <dxi-location style="margin-top: .20rem" screen="xs sm" [row]="12" [col]="0" [colspan]="12"></dxi-location>
                    <div>
                        <dx-button stylingMode="contained" text="Buscar" icon="search" type="normal" [width]="120" (onClick)="buscarClick($event)">
                        </dx-button>
                    </div>
                </dxi-item>

            </dx-responsive-box>
            <br><br>

            

            <!-- <dx-chart id="chart" [dataSource]="graficaModel" palette="soft" title="Kilómetros por Udn">
            
                <dxi-series valueField="kmstotalC" name="kilometros cargados" color="#363640">
                    <dxo-label [visible]="true" [format]="separator" position="inside">
                        <dxo-font size="9"></dxo-font>
                    </dxo-label>
                </dxi-series>
                <dxi-series valueField="kmstotalV" name="kilometros vacios" color="#FA593F">
                    <dxo-label [visible]="true" [format]="separator" position="inside">
                        <dxo-font size="9"></dxo-font>
                    </dxo-label>
                </dxi-series>
                <dxo-common-series-settings
                    argumentField="udN"
                    type="bar"
                    [ignoreEmptyPoints]="true"
                >
                </dxo-common-series-settings>
                <dxo-legend verticalAlignment="bottom" horizontalAlignment="center">
                </dxo-legend>
                <dxo-export [enabled]="true"></dxo-export>
            </dx-chart> -->

           
            
         <br>
           
         <dx-data-grid  #ING id="gridContainer8" [dataSource]="kmsMensykaes" [height]="700"[showBorders]="true" [columnAutoWidth]="true" 
                    (onRowPrepared)="onRowPreparedKMS($event)" (onCellPrepared)="onCellPreparedIKMS($event)">
        
                    <dxo-search-panel [visible]="true" [width]="240" placeholder="Buscar..."></dxo-search-panel>
                    <dxo-header-filter [visible]="true"></dxo-header-filter>

                    <dxi-column dataField="anio" caption="Año" [fixed]="true" [width]="100"></dxi-column>
                    <dxi-column dataField="mes" caption="Mes" [fixed]="true" [width]="70"></dxi-column>
                    <dxi-column dataField="udN" caption="UdN" [fixed]="true" [width]="150"></dxi-column>
                    <dxi-column dataField="noViaje" caption="No. Viaje" [fixed]="true" [width]="100"></dxi-column>
                    <dxi-column dataField="operador" caption="Operador" [width]="250"></dxi-column>
                    <dxi-column dataField="cliente" caption="Cliente" [width]="250"></dxi-column>
                    <dxi-column dataField="tracto" caption="Tracto" [width]="100"></dxi-column>
                    <dxi-column dataField="rem1" caption="Rem. 1" [width]="100"></dxi-column>
                    <dxi-column dataField="descRem1" caption="Desc. Rem. 1" [width]="100"></dxi-column>
                    <dxi-column dataField="rem2" caption="Rem. 2" [width]="100"></dxi-column>
                    <dxi-column dataField="descripcion" caption="Descripción" [width]="170"></dxi-column>
                    <dxi-column dataField="tipoViaje" caption="Tipo viaje" [width]="100"></dxi-column>
                    <dxi-column dataField="operacion" caption="Operación" [width]="150"></dxi-column>
                    <dxi-column dataField="fecha" caption="Fecha" dataType="date" format="dd/MM/yyyy" [width]="150"></dxi-column>
                    <dxi-column dataField="origen" caption="Origen" [width]="180"></dxi-column>
                    <dxi-column dataField="edoOrigen" caption="Edo. Origen" [width]="120"></dxi-column>
                    <dxi-column dataField="municipioOrigen" caption="Municipio Origen" [width]="170"></dxi-column>
                    <dxi-column dataField="destino" caption="Destino" [width]="180"></dxi-column>
                    <dxi-column dataField="edoDestino" caption="Edo. Destino" [width]="120"></dxi-column>
                    <dxi-column dataField="municipioDestino" caption="Municipio Destino" [width]="170"></dxi-column>
                    <dxi-column dataField="modelo" caption="Modelo" [width]="100"></dxi-column>
                    <dxi-column dataField="kmsRuta" caption="Kms. Ruta" [format]="separator" [width]="100"></dxi-column>
                    <dxi-column dataField="kmsReal" caption="Kms. Real" [format]="separator" [width]="100"></dxi-column>
                    <dxi-column dataField="desviacion" caption="Desviación" format="percent" [width]="120"></dxi-column>
                    <dxi-column dataField="autorizado" caption="Autorizado" [width]="130"></dxi-column>
                    <dxi-column dataField="kmsReporte" caption="Kms. Reporte" [format]="separator" [width]="130"></dxi-column>
                    <dxi-column dataField="diesel" caption="Diesel" [format]="separatorKV" [width]="100"></dxi-column>
                    <dxi-column dataField="rendimiento" caption="Rendimiento" [format]="redondearD" [width]="130"></dxi-column>
                    <dxi-column dataField="liquidado" caption="Liquidado" [width]="100"></dxi-column>
                    <dxi-column dataField="no_liquidacion" caption="No. Liquidación" [width]="130"></dxi-column>
                    <dxi-column dataField="fecha_liquidacion" caption="Fecha liquidación" dataType="date" format="dd/MM/yyyy" [width]="150"></dxi-column>
                    <dxi-column dataField="mesLiquidacion" caption="Mes liquidación" [width]="150"></dxi-column>
                    <dxi-column dataField="despachoViaje" caption="Despacho viaje" dataType="date" format="dd/MM/yyyy" [width]="150"></dxi-column>
                    <dxi-column dataField="finViaje" caption="Fin viaje" dataType="date" format="dd/MM/yyyy" [width]="150"></dxi-column>
                    <dxi-column dataField="finalizado" caption="Finalizado" [width]="120"></dxi-column>
                    <dxi-column dataField="diasSinLiquidar" caption="Días sin liquidar" [width]="150"></dxi-column>
                    <dxi-column dataField="periodo" caption="Periodo" [width]="100"></dxi-column>
                    <dxi-column dataField="flete" caption="Flete" format="$ #,###,###.##;-$ #,##0.##" [width]="100"></dxi-column>
                    <dxi-column dataField="diaMes" caption="Día mes" [width]="100"></dxi-column>
                    <dxi-column dataField="toneladas" caption="Toneladas" [width]="100"></dxi-column>
                    <dxi-column dataField="dolly" caption="Dolly" [width]="100"></dxi-column>
                    
                    

                    <dxo-group-panel [visible]="false"></dxo-group-panel>
                    <dxo-grouping #expand [autoExpandAll]="false"></dxo-grouping>
                    <dxo-export [enabled]="true" fileName="KMS Mensuales" [customizeExcelCell]="customizeI"></dxo-export>
                    <dxo-paging [pageSize]="60"></dxo-paging>
                    <dxo-sorting mode="none"></dxo-sorting>

                    </dx-data-grid>

        </dxi-item>

        <dxi-item title="KPI´s">
            <dx-chart id="chart1" [dataSource]="kmsXOperacion" palette="pastel" [rotated]="false">
                <dxi-value-axis [maxValueMargin]=".15"></dxi-value-axis>
                <dxo-common-series-settings argumentField="tipoOperacion" type="bar" valueField="valor">
                    <dxo-label [visible]="true" position="outside" [rotationAngle]="-90"
                     backgroundColor="transparent" [verticalOffset]="15">
                        <dxo-font size="11" color="black" weight="bold"></dxo-font>
                    </dxo-label>
                </dxo-common-series-settings>
                <dxo-series-template nameField="mes" [customizeSeries]="customizeSeries"></dxo-series-template>
                <dxo-title text="MILLONES DE KMS RECORRIDOS POR TIPO DE OPERACIÓN"></dxo-title>
                <dxo-legend verticalAlignment="bottom" horizontalAlignment="center"></dxo-legend>
                <dxo-export [enabled]="true" fileName="MILLONES DE KMS RECORRIDOS POR TIPO DE OPERACIÓN"></dxo-export>
            </dx-chart>
            <br><br>

            <dx-chart id="chart2" [dataSource]="kmsXUdn" palette="pastel" [rotated]="false">
                <dxi-value-axis [maxValueMargin]=".15"></dxi-value-axis>
                <dxo-common-series-settings argumentField="tipoOperacion" type="bar" valueField="valor">
                    <dxo-label [visible]="true" position="outside" [rotationAngle]="-90"
                     backgroundColor="transparent" [verticalOffset]="15">
                        <dxo-font size="11" color="black" weight="bold"></dxo-font>
                    </dxo-label>
                </dxo-common-series-settings>
                <dxo-series-template nameField="mes" [customizeSeries]="customizeSeries"></dxo-series-template>
                <dxo-title text="MILLONES KMS RECORRIDOS UDN"></dxo-title>
                <dxo-legend verticalAlignment="bottom" horizontalAlignment="center"></dxo-legend>
                <dxo-export [enabled]="true" fileName="MILLONES KMS RECORRIDOS UDN"></dxo-export>
            </dx-chart>
            <br><br>

            <dx-chart id="chart3" [dataSource]="porXOperacion" palette="pastel" [rotated]="false">
                <dxi-value-axis [maxValueMargin]=".44"></dxi-value-axis>
                <dxo-common-series-settings argumentField="tipoOperacion" type="bar" valueField="valor">
                    <dxo-label [visible]="true" position="outside" [customizeText]="formatSliderTooltip"
                     [rotationAngle]="-90" backgroundColor="transparent" [verticalOffset]="15">
                        <dxo-font size="11" color="black" weight="bold"></dxo-font>
                    </dxo-label>
                </dxo-common-series-settings>
                <dxo-series-template nameField="mes" [customizeSeries]="customizeSeries"></dxo-series-template>
                <dxo-title text="% KMS POR TIPO OPERACIÓN"></dxo-title>
                <dxo-legend verticalAlignment="bottom" horizontalAlignment="center"></dxo-legend>
                <dxo-export [enabled]="true" fileName="% KMS POR TIPO OPERACIÓN"></dxo-export>
            </dx-chart>
            <br><br>

            <dx-chart id="chart4" [dataSource]="porXCargadosUdn" palette="pastel" [rotated]="false">
                <dxi-value-axis [maxValueMargin]=".15"></dxi-value-axis>
                <dxo-common-series-settings argumentField="tipoOperacion" type="bar" valueField="valor">
                    <dxo-label [visible]="true" position="outside" [customizeText]="formatSliderTooltip"
                     [rotationAngle]="-90" backgroundColor="transparent" [verticalOffset]="15">
                        <dxo-font size="11" color="black" weight="bold"></dxo-font>
                    </dxo-label>
                </dxo-common-series-settings>
                <dxo-series-template nameField="mes" [customizeSeries]="customizeSeries"></dxo-series-template>
                <dxo-title text="% KMS CARGADOS UDN"></dxo-title>
                <dxo-legend verticalAlignment="bottom" horizontalAlignment="center"></dxo-legend>
                <dxo-export [enabled]="true" fileName="% KMS CARGADOS UDN"></dxo-export>
            </dx-chart>
            <br><br>

            <dx-chart id="chart5" [dataSource]="porXFlotaOperacion" palette="pastel" [rotated]="false">
                <dxi-value-axis [maxValueMargin]=".44"></dxi-value-axis>
                <dxo-common-series-settings argumentField="tipoOperacion" type="bar" valueField="valor">
                    <dxo-label [visible]="true" position="outside" [customizeText]="formatSliderTooltip"
                     [rotationAngle]="-90" backgroundColor="transparent" [verticalOffset]="15">
                        <dxo-font size="11" color="black" weight="bold"></dxo-font>
                    </dxo-label>
                </dxo-common-series-settings>
                <dxo-series-template nameField="mes" [customizeSeries]="customizeSeries"></dxo-series-template>
                <dxo-title text="% FLOTA ACTIVA TIPO OPERACIÓN"></dxo-title>
                <dxo-legend verticalAlignment="bottom" horizontalAlignment="center"></dxo-legend>
                <dxo-export [enabled]="true" fileName="% FLOTA ACTIVA TIPO OPERACIÓN"></dxo-export>
            </dx-chart>
            <br><br>

            <dx-chart id="chart6" [dataSource]="porXFlotaUdn" palette="pastel" [rotated]="false">
                <dxi-value-axis [maxValueMargin]=".15"></dxi-value-axis>
                <dxo-common-series-settings argumentField="tipoOperacion" type="bar" valueField="valor">
                    <dxo-label [visible]="true" position="outside" [customizeText]="formatSliderTooltip"
                     [rotationAngle]="-90" backgroundColor="transparent" [verticalOffset]="15">
                        <dxo-font size="11" color="black" weight="bold"></dxo-font>
                    </dxo-label>
                </dxo-common-series-settings>
                <dxo-series-template nameField="mes" [customizeSeries]="customizeSeries"></dxo-series-template>
                <dxo-title text="% FLOTA ACTIVA UDN"></dxo-title>
                <dxo-legend verticalAlignment="bottom" horizontalAlignment="center"></dxo-legend>
                <dxo-export [enabled]="true" fileName="% FLOTA ACTIVA UDN"></dxo-export>
            </dx-chart>
            <br><br>

        </dxi-item>
    </dx-tab-panel>
   
        <!-- LOAD PANEL -->
        <dx-load-panel #loadPanel shadingColor="rgba(0,0,0,0.4)" [position]="{ of: '#rentCont2' }" [(visible)]="loadingVisible" [showIndicator]="true" [showPane]="true" [shading]="true" [closeOnOutsideClick]="false">
        </dx-load-panel>
</div>
